<%- include('includes/header') %>
<%- include('includes/navbar', {needFull: true}) %>

<div class="container">
    <div class="row">
        <div class="col-12 text-center">
            <h2 style="margin: 1em 0 1em 0;">View Developer</h2>
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <span class="h2">
                <%= dev.name %>
            </span>
        </div>
        <div style="margin-left: 20px; margin-top: 10px;" class="col-12">
            <ion-icon name="at-outline"></ion-icon>&nbsp;<%= dev.email %>
        </div>
        <% if (dev.phone !== "") { %>
            <div style="margin-left: 20px;" class="col-12">
                <ion-icon name="call-outline"></ion-icon>&nbsp;<%= dev.phone %>
            </div>
        <% } %>
    </div>
    <div style="margin: 40px 0 10px 0;" class="row">
        <div class="col-12">
            Memberships:
        </div>
    </div>
    <table class="table">
        <thead>
            <tr>
                <th class="text-center" scope="col">#</th>
                <th scope="col">Project</th>
                <th scope="col">Leader</th>
                <th scope="col">Rank</th>
                <th class="d-none d-lg-block text-right" scope="col">Joined on</th>
                <th class="text-right" scope="col"> </th>
            </tr>
        </thead>
        <tbody>
            <% dev.memberships.forEach( function(membership, index) { %>
            <tr>
                <th class="text-center" scope="row"><%= dev.memberships.length - index %></th>
                <td><%= membership._proj.title %></td>
                <td><%= membership._proj._leader.name %></td>
                <td><%= membership.rank %></td>
                <td class="d-none d-lg-block text-right"><%= membership.joinDateString %></td>
                <td class="text-right">
                    <button class="btn btn-primary dropdown-toggle" data-toggle="dropdown"></button>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="btnGroupDrop1">
                        <a href="/projects/<%= membership._proj._id %>" class="dropdown-item">
                            <ion-icon name="search-outline"></ion-icon>&nbsp;View Project
                        </a>
                        <%# User can quit projects that they are not leader of: %> 
                        <% if (dev._id == userID && membership._proj._leader._id != userID) { %>
                            <div class="dropdown-divider"></div>
                            <a href="/projects/kick/<%= membership._id %>" class="dropdown-item">
                                <ion-icon name="walk-outline"></ion-icon>&nbsp;Quit Project
                            </a>
                        <% } %>                        
                    </div>
                </td>
            </tr>
            <% }); %>
        </tbody>
    </table>

    <div class="row">
        <div class="col-12">
            <a href="javascript:history.back()" class="btn btn-danger">
                <ion-icon name="arrow-back-outline"></ion-icon>&nbsp;Back
            </a>
        </div>
    </div>
</div>

<%- include('includes/footer') %>